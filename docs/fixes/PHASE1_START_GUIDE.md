# Phase 1 å¿«é€Ÿå¯åŠ¨æŒ‡å—

**çŠ¶æ€**: ğŸ”„ ç«‹å³å¼€å§‹  
**èµ·å§‹æ—¶é—´**: 2025-10-31  
**ç›®æ ‡**: å®Œæˆç»˜åˆ¶å·¥å…·çš„é›†æˆå’Œæµ‹è¯•

---

## ğŸš€ 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ é˜…è¯»æ ¸å¿ƒæ–‡æ¡£ï¼ˆ5 åˆ†é’Ÿï¼‰

æŒ‰ç…§ä»¥ä¸‹é¡ºåºé˜…è¯»ï¼š

1. **å¿«é€Ÿå‚è€ƒ** ğŸ“–
   - æ–‡ä»¶: `Qingyu_fronted/DRAW_ENGINE_QUICK_REFERENCE.md`
   - ç›®çš„: å¿«é€Ÿäº†è§£ API å’Œç”¨æ³•

2. **é›†æˆè®¡åˆ’** ğŸ“‹
   - æ–‡ä»¶: `Qingyu_fronted/PHASE1_INTEGRATION_PLAN.md`
   - ç›®çš„: ç†è§£æ€»ä½“ä»»åŠ¡åˆ†è§£å’Œæ—¶é—´è¡¨

3. **Task 1 æ£€æŸ¥æ¸…å•** âœ…
   - æ–‡ä»¶: `Qingyu_fronted/PHASE1_TASK1_CHECKLIST.md`
   - ç›®çš„: è·å–è¯¦ç»†çš„å®æ–½æ­¥éª¤

---

## ğŸ“ å…³é”®æ–‡ä»¶ä½ç½®

### æ ¸å¿ƒç»˜åˆ¶å·¥å…·ï¼ˆå·²å®Œæˆ âœ“ï¼‰
```
src/core/draw-engine/
â”œâ”€â”€ types.ts              # ç±»å‹å®šä¹‰ âœ“
â”œâ”€â”€ draw-engine.ts        # æ ¸å¿ƒå¼•æ“ âœ“
â”œâ”€â”€ export-service.ts     # å¯¼å‡ºæœåŠ¡ âœ“
â””â”€â”€ README.md             # å®Œæ•´ API æ–‡æ¡£ âœ“

src/shared/components/draw/
â””â”€â”€ DrawCanvas.vue        # Vue ç»„ä»¶ âœ“
```

### é›†æˆå‚è€ƒæ¨¡æ¿ï¼ˆæ–°å¢ï¼‰
```
Qingyu_fronted/
â”œâ”€â”€ OutlineView_DrawCanvas_Integration.vue    # Task 1 é›†æˆæ¨¡æ¿
â”œâ”€â”€ PHASE1_INTEGRATION_PLAN.md                # Phase 1 æ€»ä½“è®¡åˆ’
â”œâ”€â”€ PHASE1_TASK1_CHECKLIST.md                 # Task 1 è¯¦ç»†æ¸…å•
â””â”€â”€ PHASE1_START_GUIDE.md                     # æœ¬æ–‡æ¡£
```

### å¾…ä¿®æ”¹æ–‡ä»¶
```
src/modules/writer/views/
â”œâ”€â”€ OutlineView.vue          # â† Task 1: éœ€è¦é›†æˆ ğŸ¯
â”œâ”€â”€ EncyclopediaView.vue     # â† Task 2: éœ€è¦é›†æˆ
â””â”€â”€ CharacterGraphView.vue   # â† Task 3: éœ€è¦é›†æˆ
```

---

## ğŸ¯ Task 1: OutlineView é›†æˆæ­¥éª¤

### ç¬¬ 1 æ­¥: å­¦ä¹ é›†æˆæ¨¡æ¿ (30 åˆ†é’Ÿ)

æ‰“å¼€å‚è€ƒæ–‡ä»¶æŸ¥çœ‹å®Œæ•´çš„å®ç°:
```
Qingyu_fronted/src/modules/writer/views/OutlineView_DrawCanvas_Integration.vue
```

**å…³é”®è¦ç‚¹**:
1. âœ… å¦‚ä½•å¯¼å…¥ `DrawCanvas` ç»„ä»¶
2. âœ… å¦‚ä½•é…ç½® `mindmapConfig`
3. âœ… å¦‚ä½•åˆ›å»º `outlineData` è®¡ç®—å±æ€§
4. âœ… å¦‚ä½•å®ç°æ•°æ®è½¬æ¢é€»è¾‘
5. âœ… å¦‚ä½•å¤„ç†äº‹ä»¶å’ŒåŒæ­¥

### ç¬¬ 2 æ­¥: ä¿®æ”¹ OutlineView.vue (2-3 å°æ—¶)

æŒ‰ç…§æ£€æŸ¥æ¸…å•é€æ­¥ä¿®æ”¹:

**1. æ·»åŠ å¯¼å…¥** (5 åˆ†é’Ÿ)
```typescript
import DrawCanvas from '@/shared/components/draw/DrawCanvas.vue'
import DrawExportService from '@/core/draw-engine/export-service'
import type { DrawNode, DrawEdge } from '@/core/draw-engine/types'
```

**2. æ·»åŠ è§†å›¾çŠ¶æ€** (5 åˆ†é’Ÿ)
```typescript
const viewMode = ref<'tree' | 'mindmap'>('tree')
```

**3. æ·»åŠ é…ç½®å’Œè®¡ç®—å±æ€§** (30 åˆ†é’Ÿ)
```typescript
const mindmapConfig = { /* é…ç½®å¯¹è±¡ */ }
const outlineData = computed(() => { /* è½¬æ¢é€»è¾‘ */ })
```

**4. æ·»åŠ  UI å…ƒç´ ** (20 åˆ†é’Ÿ)
- è§†å›¾åˆ‡æ¢æŒ‰é’®
- æ€ç»´å¯¼å›¾è§†å›¾å®¹å™¨
- DrawCanvas ç»„ä»¶

**5. å®ç°äº‹ä»¶å¤„ç†å™¨** (1 å°æ—¶)
```typescript
// æœ€å…³é”®çš„ä¸‰ä¸ªå¤„ç†å™¨:
- handleOutlineNodeChanged()    // åŒæ­¥æ›´æ”¹
- handleMindmapNodeSelected()   // å¤„ç†é€‰ä¸­
- handleExportOutline()          // å¯¼å‡ºåŠŸèƒ½
```

### ç¬¬ 3 æ­¥: æµ‹è¯•é›†æˆ (1-2 å°æ—¶)

**å¿«é€Ÿæµ‹è¯•**:
```bash
# 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 2. æ‰“å¼€å¤§çº²è§†å›¾
# 3. ç‚¹å‡»æ€ç»´å¯¼å›¾æŒ‰é’®
# 4. éªŒè¯æ˜¾ç¤ºæ­£å¸¸

# 5. åœ¨æ€ç»´å¯¼å›¾ä¸­ç¼–è¾‘èŠ‚ç‚¹
# 6. åˆ‡æ¢åˆ°æ ‘å½¢è§†å›¾
# 7. éªŒè¯æ•°æ®åŒæ­¥
```

**éªŒè¯æ¸…å•**:
- [ ] æ€ç»´å¯¼å›¾æ˜¾ç¤ºæ­£å¸¸
- [ ] èŠ‚ç‚¹å’Œè¿æ¥æ­£ç¡®
- [ ] è§†å›¾åˆ‡æ¢æµç•…
- [ ] ç¼–è¾‘åŒæ­¥æ­£å¸¸
- [ ] å¯¼å‡ºåŠŸèƒ½å·¥ä½œ
- [ ] æ²¡æœ‰æ§åˆ¶å°é”™è¯¯

### ç¬¬ 4 æ­¥: ç¼–å†™å•å…ƒæµ‹è¯• (1-2 å°æ—¶)

**æµ‹è¯•æ–‡ä»¶**: `src/modules/writer/views/__tests__/OutlineView.spec.ts`

**å¿…éœ€çš„æµ‹è¯•**:
```typescript
âœ“ ç»„ä»¶æŒ‚è½½æµ‹è¯•
âœ“ è§†å›¾åˆ‡æ¢æµ‹è¯•
âœ“ æ•°æ®è½¬æ¢æµ‹è¯•
âœ“ äº‹ä»¶å¤„ç†æµ‹è¯•
âœ“ å¯¼å‡ºåŠŸèƒ½æµ‹è¯•
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### æ¯æ—¥å·¥ä½œæµç¨‹

**ä¸Šåˆ** (2-3 å°æ—¶)
```
1. å›é¡¾ä»»åŠ¡æ¸…å•
2. å®æ–½ä»£ç å˜æ›´
3. æµ‹è¯•åŸºç¡€åŠŸèƒ½
4. ä¿®å¤å‘ç°çš„é—®é¢˜
```

**ä¸‹åˆ** (1-2 å°æ—¶)
```
1. ç¼–å†™å•å…ƒæµ‹è¯•
2. è¿è¡Œæµ‹è¯•å¥—ä»¶
3. ä¿®æ”¹æµ‹è¯•å¤±è´¥é¡¹
4. ä»£ç å®¡æŸ¥å‡†å¤‡
```

**æ™šé—´** (å¯é€‰)
```
1. æ–‡æ¡£æ›´æ–°
2. é›†æˆæµ‹è¯•
3. æ€§èƒ½ä¼˜åŒ–
```

### æäº¤è§„èŒƒ

**Git æäº¤æ¶ˆæ¯**:
```bash
feat(outline): add mindmap view with DrawCanvas integration

- Add view toggle between tree and mindmap
- Implement tree to graph data conversion
- Add node editing sync
- Support markdown export

Closes: #XXX
```

---

## ğŸ“Š è¿›åº¦è·Ÿè¸ª

### Task 1 è¿›åº¦

```
Overall: â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 40%

ç»†èŠ‚è¿›åº¦:
â”œâ”€ ä»£ç é›†æˆ:        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%
â”œâ”€ å•å…ƒæµ‹è¯•:        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%
â”œâ”€ é›†æˆæµ‹è¯•:        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%
â”œâ”€ ä»£ç å®¡æŸ¥:        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%
â””â”€ æ–‡æ¡£å®Œæˆ:        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60%
```

### å®Œæˆæ¡ä»¶

- [ ] æ‰€æœ‰ä»£ç é›†æˆå®Œæˆ
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡ (>85% è¦†ç›–)
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] æ²¡æœ‰ ESLint é”™è¯¯
- [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡
- [ ] æ–‡æ¡£å®Œæ•´

---

## ğŸ’¡ å…³é”®å®ç°æç¤º

### ğŸ’¡ æç¤º 1: æ•°æ®è½¬æ¢çš„å…³é”®é€»è¾‘

å¤§çº²æ ‘ â†’ å›¾å½¢æ•°æ® çš„è½¬æ¢æ˜¯æ ¸å¿ƒã€‚ä½¿ç”¨é€’å½’éå†ï¼š

```typescript
const buildNodes = (treeNodes, parentPos, level) => {
  treeNodes.forEach((node, index) => {
    // è®¡ç®—ä½ç½®
    const x = parentPos.x + (index - Math.floor(count/2)) * xOffset
    const y = parentPos.y + yOffset * level
    
    // åˆ›å»º DrawNode
    const drawNode = { id, label, x, y, ... }
    nodes.push(drawNode)
    
    // åˆ›å»ºè¿æ¥
    if (node.parentId) {
      edges.push({ fromNodeId, toNodeId, ... })
    }
    
    // é€’å½’å­èŠ‚ç‚¹
    if (node.children) buildNodes(node.children, {x,y}, level+1)
  })
}
```

### ğŸ’¡ æç¤º 2: äº‹ä»¶åŒæ­¥çš„æ­£ç¡®æ–¹å¼

æ€ç»´å¯¼å›¾ â†” æ ‘å½¢è§†å›¾ çš„åŒæ­¥éœ€è¦å°å¿ƒå¤„ç†ï¼š

```typescript
// âœ… æ­£ç¡®æ–¹å¼ï¼šé€šè¿‡ store
handleOutlineNodeChanged = async (node) => {
  // 1. æ›´æ–° API
  await updateNode(node.id, { title: node.label })
  // 2. é‡æ–°åŠ è½½æ ‘
  await writerStore.loadOutlineTree()
  // 3. è‡ªåŠ¨è§¦å‘ outlineData æ›´æ–°
  // 4. æ€ç»´å¯¼å›¾ä¹Ÿè‡ªåŠ¨æ›´æ–°
}

// âŒ é”™è¯¯æ–¹å¼ï¼šç›´æ¥ä¿®æ”¹çŠ¶æ€
// é¿å…ç›´æ¥ä¿®æ”¹ store çŠ¶æ€ï¼Œè¿™ä¼šå¯¼è‡´ä¸ä¸€è‡´
```

### ğŸ’¡ æç¤º 3: æ€§èƒ½ä¼˜åŒ–

å¤„ç†å¤§çº²è¶…è¿‡ 100 ä¸ªèŠ‚ç‚¹æ—¶ï¼š

```typescript
const mindmapConfig = {
  enableGrid: false,        // ç¦ç”¨ç½‘æ ¼åŠ å¿«æ¸²æŸ“
  snapToGrid: false,
  gridSize: 50,             // å¢åŠ ç½‘æ ¼å¤§å°
  enableHistory: false,     // ç¦ç”¨å†å²ï¼ˆå¯é€‰ï¼‰
  minZoom: 0.2,
  maxZoom: 3
}
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ€ç»´å¯¼å›¾ä¸æ˜¾ç¤º

**ç—‡çŠ¶**: ç‚¹å‡»æ€ç»´å¯¼å›¾æŒ‰é’®ï¼Œæ²¡æœ‰æ˜¾ç¤ºä»»ä½•å†…å®¹

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ DrawCanvas æ˜¯å¦æ­£ç¡®å¯¼å…¥
2. éªŒè¯ outlineData æ˜¯å¦æœ‰æ•°æ®
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
4. æ£€æŸ¥ CSS æ ·å¼æ˜¯å¦éšè—äº†å†…å®¹

### é—®é¢˜ 2: æ•°æ®ä¸åŒæ­¥

**ç—‡çŠ¶**: ä¿®æ”¹æ€ç»´å¯¼å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œæ ‘å½¢è§†å›¾æ²¡æœ‰æ›´æ–°

**æ’æŸ¥æ­¥éª¤**:
1. éªŒè¯ handleOutlineNodeChanged æ˜¯å¦è¢«è°ƒç”¨
2. æ£€æŸ¥ API è°ƒç”¨æ˜¯å¦æˆåŠŸ
3. ç¡®è®¤ store reload å·¥ä½œæ­£å¸¸
4. æ£€æŸ¥æ˜¯å¦æœ‰ JavaScript é”™è¯¯

### é—®é¢˜ 3: æ€§èƒ½é—®é¢˜

**ç—‡çŠ¶**: æ˜¾ç¤ºå¤§é‡èŠ‚ç‚¹æ—¶ï¼Œå“åº”ç¼“æ…¢

**è§£å†³æ–¹æ¡ˆ**:
1. ç¦ç”¨ç½‘æ ¼æ¸²æŸ“
2. å¢åŠ ç½‘æ ¼å¤§å°
3. ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¦‚æœå¤§çº²è¶…è¿‡ 500 èŠ‚ç‚¹ï¼‰
4. å¼‚æ­¥åŠ è½½æ•°æ®

---

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [DrawEngine API æ–‡æ¡£](./src/core/draw-engine/README.md)
- [é›†æˆæŒ‡å—](./DRAW_ENGINE_INTEGRATION_GUIDE.md)
- [å¿«é€Ÿå‚è€ƒ](./DRAW_ENGINE_QUICK_REFERENCE.md)

### ç¤ºä¾‹ä»£ç 
- [å®Œæ•´é›†æˆæ¨¡æ¿](./OutlineView_DrawCanvas_Integration.vue)
- [ç›¸å…³æµ‹è¯•ç¤ºä¾‹](./src/modules/writer/__tests__/)

### å¤–éƒ¨èµ„æº
- [Vue 3 æ–‡æ¡£](https://vuejs.org/)
- [Element Plus æ–‡æ¡£](https://element-plus.org/)
- [TypeScript æ–‡æ¡£](https://www.typescriptlang.org/)

---

## ğŸ“ è·å–å¸®åŠ©

### å¸¸è§é—®é¢˜

1. **Q: å¦‚ä½•å¿«é€Ÿç†è§£æ•°æ®è½¬æ¢é€»è¾‘ï¼Ÿ**
   - A: çœ‹ `OutlineView_DrawCanvas_Integration.vue` ä¸­çš„ `outlineData` è®¡ç®—å±æ€§

2. **Q: å¦‚ä½•è°ƒè¯•æ€ç»´å¯¼å›¾æ˜¾ç¤ºé—®é¢˜ï¼Ÿ**
   - A: åœ¨æµè§ˆå™¨ DevTools ä¸­æ£€æŸ¥ DrawCanvas çš„ propsï¼Œç‰¹åˆ«æ˜¯ initialData

3. **Q: æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æŠ€å·§ï¼Ÿ**
   - A: æŸ¥çœ‹æ•…éšœæ’é™¤ç« èŠ‚çš„"æ€§èƒ½é—®é¢˜"

4. **Q: å¦‚ä½•ç¼–å†™æµ‹è¯•ï¼Ÿ**
   - A: å‚è€ƒæ£€æŸ¥æ¸…å•ä¸­çš„ Phase 1.2 å•å…ƒæµ‹è¯•éƒ¨åˆ†

### æ²Ÿé€šæ¸ é“

- ğŸ“§ Email: æäº¤é—®é¢˜çš„è¯¦ç»†æè¿°
- ğŸ’¬ Slack: è®¨è®ºæŠ€æœ¯ç»†èŠ‚
- ğŸ“‹ GitHub Issues: æäº¤ Bug æˆ–åŠŸèƒ½è¯·æ±‚

---

## â±ï¸ é¢„è®¡æ—¶é—´è¡¨

| ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | å¼€å§‹æ—¥æœŸ | å®Œæˆæ—¥æœŸ |
|------|---------|---------|---------|
| å­¦ä¹ å’Œå‡†å¤‡ | 1h | 10-31 | 10-31 |
| ä»£ç é›†æˆ | 2-3h | 10-31 | 11-01 |
| å•å…ƒæµ‹è¯• | 1-2h | 11-01 | 11-01 |
| é›†æˆæµ‹è¯• | 1-2h | 11-01 | 11-02 |
| ä»£ç å®¡æŸ¥ | 1h | 11-02 | 11-02 |
| é—®é¢˜ä¿®å¤ | 1h | 11-02 | 11-03 |
| **æ€»è®¡** | **7-10h** | **10-31** | **11-03** |

---

## âœ… æœ€ç»ˆæ£€æŸ¥æ¸…å•

åœ¨æäº¤å‰éªŒè¯ï¼š

```
ä»£ç è´¨é‡:
â˜ éµå¾ª ESLint è§„åˆ™
â˜ é€šè¿‡ TypeScript ç±»å‹æ£€æŸ¥
â˜ ä»£ç æœ‰æ³¨é‡Šå’Œæ–‡æ¡£

åŠŸèƒ½å®Œæ•´:
â˜ æ€ç»´å¯¼å›¾è§†å›¾æ˜¾ç¤ºæ­£å¸¸
â˜ è§†å›¾åˆ‡æ¢æµç•…
â˜ æ•°æ®åŒæ­¥æ­£ç¡®
â˜ å¯¼å‡ºåŠŸèƒ½å·¥ä½œ

æµ‹è¯•è¦†ç›–:
â˜ å•å…ƒæµ‹è¯• > 85%
â˜ é›†æˆæµ‹è¯•å…¨éƒ¨é€šè¿‡
â˜ æ²¡æœ‰æ§åˆ¶å°é”™è¯¯

æ–‡æ¡£å®Œæ•´:
â˜ ä»£ç æ³¨é‡Šæ¸…æ™°
â˜ é›†æˆæŒ‡å—å·²æ›´æ–°
â˜ ç¤ºä¾‹ä»£ç æœ‰æ•ˆ

æ€§èƒ½:
â˜ ç»„ä»¶åŠ è½½ < 500ms
â˜ è§†å›¾åˆ‡æ¢ < 300ms
â˜ å†…å­˜å ç”¨æ­£å¸¸
```

---

**ç¥ä½ å¼€å‘é¡ºåˆ©! ğŸš€**

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒç›¸å…³æ–‡æ¡£æˆ–æäº¤é—®é¢˜ã€‚

**æœ€åæ›´æ–°**: 2025-10-31
