# 社交模块快速参考

> **最后更新：** 2025-01-14
> **模块路径：** `src/modules/social/api/`
> **错误码范围：** 7000-7999

## 评论接口

### 获取评论列表
- **接口：** `GET /api/v1/social/comments`
- **认证：** 需要
- **说明：** 获取书籍或章节的评论列表

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| book_id | string | ✓ | 书籍ID | - |
| chapter_id | string | ✗ | 章节ID | - |
| sort_by | string | ✗ | 排序(latest/hot) | latest |
| page | number | ✗ | 页码 | 1 |
| size | number | ✗ | 每页数量 | 20 |

**错误码：** 7001-7010
**详细文档：** [查看详细指南](../guides/social/comment.md)

---

### 发表评论
- **接口：** `POST /api/v1/social/comments`
- **认证：** 需要
- **说明：** 发表书籍或章节评论

**请求体：**
| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| book_id | string | ✓ | 书籍ID |
| chapter_id | string | ✗ | 章节ID |
| content | string | ✓ | 评论内容(10-500字符) |
| rating | number | ✗ | 评分(0-5) |

**错误码：** 7001-7010
**详细文档：** [查看详细指南](../guides/social/comment.md)

---

### 删除评论
- **接口：** `DELETE /api/v1/social/comments/{id}`
- **认证：** 需要
- **说明：** 删除指定评论

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | ✓ | 评论ID |

**错误码：** 7011-7015
**详细文档：** [查看详细指南](../guides/social/comment.md)

---

## 点赞接口

### 点赞
- **接口：** `POST /api/v1/social/books/{bookId}/like`
- **认证：** 需要
- **说明：** 点赞书籍

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| bookId | string | ✓ | 书籍ID |

**错误码：** 7020-7025
**详细文档：** [查看详细指南](../guides/social/like.md)

---

### 取消点赞
- **接口：** `DELETE /api/v1/social/books/{bookId}/like`
- **认证：** 需要
- **说明：** 取消书籍点赞

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| bookId | string | ✓ | 书籍ID |

**错误码：** 7020-7025
**详细文档：** [查看详细指南](../guides/social/like.md)

---

## 收藏接口

### 添加收藏
- **接口：** `POST /api/v1/social/collections`
- **认证：** 需要
- **说明：** 收藏书籍

**请求体：**
| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| book_id | string | ✓ | 书籍ID |
| folder_id | string | ✗ | 收藏夹ID |
| note | string | ✗ | 备注(最大500字符) |
| tags | string[] | ✗ | 标签列表 |
| is_public | boolean | ✗ | 是否公开 | false |

**错误码：** 7030-7040
**详细文档：** [查看详细指南](../guides/social/collection.md)

---

### 取消收藏
- **接口：** `DELETE /api/v1/social/collections/{id}`
- **认证：** 需要
- **说明：** 取消收藏

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | ✓ | 收藏ID |

**错误码：** 7030-7040
**详细文档：** [查看详细指南](../guides/social/collection.md)

---

### 获取收藏列表
- **接口：** `GET /api/v1/social/collections`
- **认证：** 需要
- **说明：** 获取用户收藏列表

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| folder_id | string | ✗ | 收藏夹ID | - |
| page | number | ✗ | 页码 | 1 |
| size | number | ✗ | 每页数量 | 20 |

**错误码：** 7030-7040
**详细文档：** [查看详细指南](../guides/social/collection.md)

---

## 消息接口

### 获取会话列表
- **接口：** `GET /api/v1/social/messages/conversations`
- **认证：** 需要
- **说明：** 获取用户的私信会话列表

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| page | number | ✗ | 页码 | 1 |
| size | number | ✗ | 每页数量 | 20 |

**错误码：** 7050-7060
**详细文档：** [查看详细指南](../guides/social/message.md)

---

### 获取会话消息
- **接口：** `GET /api/v1/social/messages/conversations/{conversationId}/messages`
- **认证：** 需要
- **说明：** 获取指定会话的消息列表

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| conversationId | string | ✓ | 会话ID |

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| page | number | ✗ | 页码 | 1 |
| size | number | ✗ | 每页数量 | 50 |

**错误码：** 7050-7060
**详细文档：** [查看详细指南](../guides/social/message.md)

---

### 发送消息
- **接口：** `POST /api/v1/social/messages/conversations/{conversationId}/messages`
- **认证：** 需要
- **说明：** 向指定会话发送消息

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| conversationId | string | ✓ | 会话ID |

**请求体：**
| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| type | string | ✓ | 消息类型(text/image/file) |
| content | string | ✓ | 消息内容(文本类型) |
| file_url | string | ✗ | 文件URL(图片/文件类型) |
| file_name | string | ✗ | 文件名 |
| file_size | number | ✗ | 文件大小(字节) |

**错误码：** 7050-7060
**详细文档：** [查看详细指南](../guides/social/message.md)

---

### 创建会话
- **接口：** `POST /api/v1/social/messages/conversations`
- **认证：** 需要
- **说明：** 创建与指定用户的对话会话

**请求体：**
| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| participant_id | string | ✓ | 对方用户ID |

**错误码：** 7050-7060
**详细文档：** [查看详细指南](../guides/social/message.md)

---

## 关注接口

### 关注用户
- **接口：** `POST /api/v1/social/users/{userId}/follow`
- **认证：** 需要
- **说明：** 关注指定用户

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| userId | string | ✓ | 用户ID |

**错误码：** 7070-7080
**详细文档：** [关注系统](../guides/social/follow.md)

---

### 取消关注用户
- **接口：** `DELETE /api/v1/social/users/{userId}/unfollow`
- **认证：** 需要
- **说明：** 取消关注用户

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| userId | string | ✓ | 用户ID |

**错误码：** 7070-7080
**详细文档：** [关注系统](../guides/social/follow.md)

---

### 获取关注列表
- **接口：** `GET /api/v1/social/users/{userId}/following`
- **认证：** 需要
- **说明：** 获取用户的关注列表

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| userId | string | ✓ | 用户ID |

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| page | number | ✗ | 页码 | 1 |
| page_size | number | ✗ | 每页数量 | 20 |

**错误码：** 7070-7080
**详细文档：** [关注系统](../guides/social/follow.md)

---

### 获取粉丝列表
- **接口：** `GET /api/v1/social/users/{userId}/followers`
- **认证：** 需要
- **说明：** 获取用户的粉丝列表

**路径参数：**
| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| userId | string | ✓ | 用户ID |

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| page | number | ✗ | 页码 | 1 |
| page_size | number | ✗ | 每页数量 | 20 |

**错误码：** 7070-7080
**详细文档：** [关注系统](../guides/social/follow.md)

---

## 书评接口

### 获取书评列表
- **接口：** `GET /api/v1/social/reviews`
- **认证：** 不需要
- **说明：** 获取书评列表

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| target_id | string | ✗ | 目标ID(书籍/章节/书单) | - |
| target_type | string | ✗ | 目标类型(book/chapter/list) | - |
| user_id | string | ✗ | 用户ID | - |
| book_id | string | ✗ | 书籍ID | - |
| sort | string | ✗ | 排序(latest/hot/rating) | latest |
| rating | number | ✗ | 评分筛选(1-5) | - |
| page | number | ✗ | 页码 | 1 |
| page_size | number | ✗ | 每页数量 | 20 |

**错误码：** 7090-7100
**详细文档：** [书评系统](../guides/social/review.md)

---

### 发表书评
- **接口：** `POST /api/v1/social/reviews`
- **认证：** 需要
- **说明：** 创建书评

**请求体：**
| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| target_id | string | ✓ | 目标ID |
| target_type | string | ✓ | 目标类型(book/chapter/list) |
| title | string | ✓ | 书评标题 |
| content | string | ✓ | 书评内容 |
| rating | number | ✓ | 评分(1-5) |
| is_spoiler | boolean | ✗ | 是否包含剧透 | false |

**错误码：** 7090-7100
**详细文档：** [书评系统](../guides/social/review.md)

---

## 书单接口

### 获取书单列表
- **接口：** `GET /api/v1/social/booklists`
- **认证：** 不需要
- **说明：** 获取书单列表

**查询参数：**
| 参数 | 类型 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| user_id | string | ✗ | 用户ID | - |
| is_public | boolean | ✗ | 是否公开 | - |
| is_official | boolean | ✗ | 是否官方书单 | - |
| tag | string | ✗ | 标签筛选 | - |
| page | number | ✗ | 页码 | 1 |
| page_size | number | ✗ | 每页数量 | 20 |

**错误码：** 7110-7120
**详细文档：** [书单系统](../guides/social/booklist.md)

---

### 创建书单
- **接口：** `POST /api/v1/social/booklists`
- **认证：** 需要
- **说明：** 创建书单

**请求体：**
| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | string | ✓ | 书单名称 |
| description | string | ✓ | 书单描述 |
| cover_url | string | ✗ | 封面URL |
| is_public | boolean | ✓ | 是否公开 |
| tags | string[] | ✗ | 标签列表 |

**错误码：** 7110-7120
**详细文档：** [书单系统](../guides/social/booklist.md)

---

## 错误码速查

### 通用错误 (1000-1999)
见 [错误处理文档](../error-handling/error-codes.md)

### 认证错误 (2000-2999)
见 [错误处理文档](../error-handling/error-codes.md)

### 评论错误 (7000-7019)
| 错误码 | 说明 |
|--------|------|
| 7001 | 评论内容过短(少于10字符) |
| 7002 | 评论内容过长(超过500字符) |
| 7003 | 书籍不存在 |
| 7004 | 评论不存在 |
| 7005 | 无权删除他人评论 |
| 7006 | 评分超出范围(0-5) |
| 7007 | 章节不存在 |
| 7008 | 评论已存在 |
| 7009 | 评论被删除 |
| 7010 | 评论审核中 |

### 点赞错误 (7020-7029)
| 错误码 | 说明 |
|--------|------|
| 7020 | 书籍不存在 |
| 7021 | 已经点赞过 |
| 7022 | 未点赞过 |
| 7023 | 点赞失败 |
| 7024 | 取消点赞失败 |

### 收藏错误 (7030-7039)
| 错误码 | 说明 |
|--------|------|
| 7030 | 书籍不存在 |
| 7031 | 已经收藏过 |
| 7032 | 收藏夹不存在 |
| 7033 | 收藏不存在 |
| 7034 | 收藏失败 |
| 7035 | 取消收藏失败 |
| 7036 | 超出收藏数量限制 |

### 消息错误 (7050-7059)
| 错误码 | 说明 |
|--------|------|
| 7050 | 会话不存在 |
| 7051 | 消息不存在 |
| 7052 | 消息内容过长(超过5000字符) |
| 7053 | 消息类型不支持 |
| 7054 | 对方用户不存在 |
| 7055 | 消息发送失败 |
| 7056 | 不能给自己发消息 |
| 7057 | 消息已撤回(超过2分钟) |
| 7058 | 文件上传失败 |
| 7059 | 文件大小超限 |

### 关注错误 (7070-7079)
| 错误码 | 说明 |
|--------|------|
| 7070 | 用户不存在 |
| 7071 | 已经关注过 |
| 7072 | 未关注过 |
| 7073 | 不能关注自己 |
| 7074 | 关注失败 |
| 7075 | 取消关注失败 |
| 7076 | 对方设置了关注限制 |
| 7077 | 超出关注数量限制 |

### 书评错误 (7090-7099)
| 错误码 | 说明 |
|--------|------|
| 7090 | 书评不存在 |
| 7091 | 书评标题过长 |
| 7092 | 书评内容过短 |
| 7093 | 无权修改他人书评 |
| 7094 | 书评已删除 |
| 7095 | 评分超出范围 |
| 7096 | 目标不存在 |
| 7097 | 书评审核中 |

### 书单错误 (7110-7119)
| 错误码 | 说明 |
|--------|------|
| 7110 | 书单不存在 |
| 7111 | 书单名称过长 |
| 7112 | 书单描述过长 |
| 7113 | 书单已删除 |
| 7114 | 书籍不在书单中 |
| 7115 | 书籍已在书单中 |
| 7116 | 书单已满 |
| 7117 | 无权修改他人书单 |

---

## 相关文档
- [数据模型 - 请求](../data-models/request-models.md)
- [数据模型 - 响应](../data-models/response-models.md)
- [错误处理指南](../error-handling/best-practices.md)
- [前端集成示例](../examples/frontend/social.api.ts)
