# 青羽平台 - 样式规范指南

> **版本**: v1.0.0  
> **最后更新**: 2025-10-29  
> **适用范围**: 所有前端开发

---

## 📋 目录

1. [CSS架构](#css架构)
2. [命名规范](#命名规范)
3. [CSS变量系统](#css变量系统)
4. [响应式设计](#响应式设计)
5. [主题系统](#主题系统)
6. [Element Plus定制](#element-plus定制)
7. [最佳实践](#最佳实践)

---

## CSS架构

### 文件组织

```
src/
├── styles/
│   ├── variables.scss      # CSS变量定义
│   ├── common.scss          # 通用样式
│   ├── admin.scss           # 管理后台样式
│   └── mixins/              # 样式混入
│       ├── _layout.scss
│       ├── _typography.scss
│       └── _utils.scss
├── shared/
│   └── components/
│       └── design-system/   # 设计系统
│           ├── tokens.ts
│           ├── colors.ts
│           ├── typography.ts
│           └── theme.ts
└── style.css                # 全局样式入口
```

### Scoped 样式

**✅ 推荐**：组件样式使用 `<style scoped>`

```vue
<template>
  <div class="book-card">
    <h3 class="book-card__title">{{ title }}</h3>
  </div>
</template>

<style scoped>
.book-card {
  padding: 16px;
  border-radius: 8px;
}

.book-card__title {
  font-size: 18px;
  font-weight: 600;
}
</style>
```

### 深度选择器

当需要影响子组件样式时，使用 `:deep()`：

```vue
<style scoped>
/* 影响子组件中的 Element Plus 按钮 */
:deep(.el-button) {
  border-radius: 4px;
}

/* 影响子组件中的自定义类 */
:deep(.child-component-class) {
  color: var(--color-primary);
}
</style>
```

**旧语法（仍支持但不推荐）**:
- `::v-deep`
- `/deep/`
- `>>>`

---

## 命名规范

### BEM命名法

采用 **BEM** (Block Element Modifier) 命名规范：

```
.block__element--modifier
```

#### 概念说明

- **Block（块）**：独立的功能组件
- **Element（元素）**：块的组成部分
- **Modifier（修饰符）**：块或元素的状态/变体

#### 命名示例

```css
/* 块 */
.book-card { }
.user-profile { }
.search-bar { }

/* 元素 */
.book-card__cover { }
.book-card__title { }
.book-card__author { }
.user-profile__avatar { }
.user-profile__name { }

/* 修饰符 */
.book-card--large { }
.book-card--featured { }
.book-card__title--highlight { }
.user-profile--vip { }
```

#### 在 Vue 中使用

```vue
<template>
  <div 
    :class="[
      'book-card',
      `book-card--${size}`,
      { 'book-card--active': isActive }
    ]"
  >
    <div class="book-card__cover">
      <img :src="cover" alt="book cover" />
    </div>
    <div class="book-card__content">
      <h3 :class="['book-card__title', { 'book-card__title--highlight': isHighlight }]">
        {{ title }}
      </h3>
      <p class="book-card__author">{{ author }}</p>
    </div>
  </div>
</template>

<script setup lang="ts">
defineProps<{
  title: string
  author: string
  cover: string
  size?: 'small' | 'medium' | 'large'
  isActive?: boolean
  isHighlight?: boolean
}>()
</script>

<style scoped>
.book-card {
  border: 1px solid var(--border-base);
  border-radius: var(--border-radius-base);
  transition: var(--transition-base);
}

.book-card--small {
  width: 150px;
}

.book-card--medium {
  width: 200px;
}

.book-card--large {
  width: 300px;
}

.book-card--active {
  box-shadow: var(--box-shadow-dark);
  border-color: var(--color-primary);
}

.book-card__cover {
  width: 100%;
  aspect-ratio: 3/4;
  overflow: hidden;
}

.book-card__title {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}

.book-card__title--highlight {
  color: var(--color-primary);
}

.book-card__author {
  font-size: 14px;
  color: var(--text-secondary);
}
</style>
```

### 命名原则

1. **使用小写字母和连字符**
   - ✅ `book-card`, `user-profile`
   - ❌ `bookCard`, `UserProfile`, `book_card`

2. **元素使用双下划线分隔**
   - ✅ `book-card__title`
   - ❌ `book-card-title`, `book-card_title`

3. **修饰符使用双连字符分隔**
   - ✅ `book-card--large`
   - ❌ `book-card-large`, `book-card_large`

4. **避免过深的嵌套**
   - ✅ `book-card__title`
   - ❌ `book-card__content__header__title`

---

## CSS变量系统

### 设计令牌

项目使用设计令牌系统，定义在 `src/shared/components/design-system/tokens.ts`：

```typescript
export const tokens = {
  colors: {
    primary: '#409eff',
    success: '#67c23a',
    warning: '#e6a23c',
    danger: '#f56c6c',
    info: '#909399',
  },
  spacing: {
    xs: '4px',
    sm: '8px',
    md: '16px',
    lg: '24px',
    xl: '32px',
  },
  // ...更多令牌
}
```

### CSS 变量定义

在 `src/styles/variables.scss` 中定义：

```scss
:root {
  /* ========== 颜色系统 ========== */
  
  /* 主色 */
  --color-primary: #409eff;
  --color-primary-light: #79bbff;
  --color-primary-lighter: #a0cfff;
  --color-primary-dark: #337ecc;
  
  /* 功能色 */
  --color-success: #67c23a;
  --color-warning: #e6a23c;
  --color-danger: #f56c6c;
  --color-info: #909399;
  
  /* 文本颜色 */
  --text-primary: #303133;
  --text-regular: #606266;
  --text-secondary: #909399;
  --text-placeholder: #c0c4cc;
  --text-disabled: #c0c4cc;
  
  /* 边框颜色 */
  --border-base: #dcdfe6;
  --border-light: #e4e7ed;
  --border-lighter: #ebeef5;
  --border-extra-light: #f2f6fc;
  
  /* 背景颜色 */
  --bg-base: #ffffff;
  --bg-page: #f2f3f5;
  --bg-overlay: rgba(0, 0, 0, 0.5);
  
  /* ========== 字体系统 ========== */
  
  /* 字体大小 */
  --font-size-extra-small: 12px;
  --font-size-small: 13px;
  --font-size-base: 14px;
  --font-size-medium: 16px;
  --font-size-large: 18px;
  --font-size-extra-large: 20px;
  
  /* 字体粗细 */
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-bold: 600;
  
  /* 行高 */
  --line-height-base: 1.5;
  --line-height-small: 1.2;
  --line-height-large: 2;
  
  /* ========== 间距系统 ========== */
  
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  --spacing-xxl: 48px;
  
  /* ========== 圆角 ========== */
  
  --border-radius-small: 2px;
  --border-radius-base: 4px;
  --border-radius-medium: 6px;
  --border-radius-large: 8px;
  --border-radius-round: 50%;
  
  /* ========== 阴影 ========== */
  
  --box-shadow-base: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);
  --box-shadow-light: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
  --box-shadow-dark: 0 2px 8px rgba(0, 0, 0, 0.15);
  
  /* ========== 过渡动画 ========== */
  
  --transition-base: all 0.3s ease;
  --transition-fast: all 0.15s ease;
  --transition-slow: all 0.5s ease;
  
  /* ========== Z-index ========== */
  
  --z-index-normal: 1;
  --z-index-top: 1000;
  --z-index-popper: 2000;
  --z-index-dialog: 3000;
  --z-index-message: 4000;
}
```

### 使用 CSS 变量

```vue
<style scoped>
.book-card {
  /* 颜色 */
  color: var(--text-primary);
  background-color: var(--bg-base);
  border: 1px solid var(--border-base);
  
  /* 间距 */
  padding: var(--spacing-md);
  margin-bottom: var(--spacing-lg);
  
  /* 圆角 */
  border-radius: var(--border-radius-base);
  
  /* 阴影 */
  box-shadow: var(--box-shadow-base);
  
  /* 过渡 */
  transition: var(--transition-base);
}

.book-card:hover {
  box-shadow: var(--box-shadow-dark);
  border-color: var(--color-primary);
}

.book-card__title {
  font-size: var(--font-size-medium);
  font-weight: var(--font-weight-bold);
  line-height: var(--line-height-base);
  color: var(--text-primary);
}

.book-card__description {
  font-size: var(--font-size-base);
  color: var(--text-secondary);
  line-height: var(--line-height-large);
}
</style>
```

---

## 响应式设计

### 断点系统

定义在 `src/shared/components/design-system/breakpoints.ts`：

```typescript
export const breakpoints = {
  xs: 0,      // 手机竖屏
  sm: 576,    // 手机横屏
  md: 768,    // 平板
  lg: 1024,   // 桌面
  xl: 1280,   // 大桌面
  xxl: 1536,  // 超大桌面
}
```

### Media Queries

```scss
/* 移动优先 */
.container {
  width: 100%;
  padding: var(--spacing-md);
}

/* 平板及以上 */
@media (min-width: 768px) {
  .container {
    width: 720px;
    margin: 0 auto;
  }
}

/* 桌面及以上 */
@media (min-width: 1024px) {
  .container {
    width: 960px;
  }
}

/* 大桌面 */
@media (min-width: 1280px) {
  .container {
    width: 1200px;
  }
}
```

### 使用 Composable

```vue
<script setup lang="ts">
import { useResponsive } from '@/composables/useResponsive'

const { isMobile, isTablet, isDesktop } = useResponsive()
</script>

<template>
  <div class="book-grid" :class="{ 
    'book-grid--mobile': isMobile,
    'book-grid--tablet': isTablet,
    'book-grid--desktop': isDesktop
  }">
    <!-- 内容 -->
  </div>
</template>

<style scoped>
.book-grid {
  display: grid;
  gap: var(--spacing-md);
}

.book-grid--mobile {
  grid-template-columns: 1fr;
}

.book-grid--tablet {
  grid-template-columns: repeat(2, 1fr);
}

.book-grid--desktop {
  grid-template-columns: repeat(4, 1fr);
}
</style>
```

### 响应式工具类

```scss
/* 显示/隐藏 */
.hidden-xs { display: none !important; }
.hidden-sm { display: none !important; }

@media (min-width: 768px) {
  .hidden-xs { display: block !important; }
  .visible-xs { display: none !important; }
}

/* 文本对齐 */
.text-left { text-align: left; }
.text-center { text-align: center; }
.text-right { text-align: right; }

@media (max-width: 768px) {
  .text-xs-center { text-align: center; }
}
```

---

## 主题系统

### 主题切换

```typescript
// src/shared/components/design-system/theme.ts
export type Theme = 'light' | 'dark'

export function setTheme(theme: Theme) {
  document.documentElement.setAttribute('data-theme', theme)
  localStorage.setItem('theme', theme)
}

export function getTheme(): Theme {
  const saved = localStorage.getItem('theme')
  return (saved as Theme) || 'light'
}

export function toggleTheme() {
  const current = getTheme()
  const next = current === 'light' ? 'dark' : 'light'
  setTheme(next)
  return next
}
```

### 暗色模式

```scss
:root {
  --color-primary: #409eff;
  --text-primary: #303133;
  --bg-base: #ffffff;
  --border-base: #dcdfe6;
}

[data-theme="dark"] {
  --color-primary: #409eff;
  --text-primary: #e5eaf3;
  --bg-base: #1a1a1a;
  --border-base: #4c4d4f;
}
```

### 阅读主题

阅读器支持多种主题：

```typescript
export const readerThemes = {
  default: {
    background: '#ffffff',
    color: '#303133',
    name: '默认'
  },
  eye: {
    background: '#c7edcc',
    color: '#2c3e50',
    name: '护眼'
  },
  night: {
    background: '#0c1021',
    color: '#7a8087',
    name: '夜间'
  },
  dark: {
    background: '#1a1a1a',
    color: '#e5eaf3',
    name: '暗黑'
  }
}
```

---

## Element Plus定制

### 方式1：CSS变量覆盖

```scss
/* styles/element-variables.scss */
:root {
  /* 主色 */
  --el-color-primary: #409eff;
  --el-color-success: #67c23a;
  --el-color-warning: #e6a23c;
  --el-color-danger: #f56c6c;
  --el-color-info: #909399;
  
  /* 圆角 */
  --el-border-radius-base: 4px;
  --el-border-radius-small: 2px;
  --el-border-radius-large: 8px;
  
  /* 字体 */
  --el-font-size-base: 14px;
  --el-font-size-small: 13px;
  --el-font-size-large: 16px;
}
```

### 方式2：组件样式覆盖

```vue
<style>
/* 全局覆盖（不使用scoped） */
.el-button {
  border-radius: 4px;
}

.el-input__inner {
  border-radius: 4px;
}
</style>

<style scoped>
/* 局部覆盖（使用 :deep） */
:deep(.el-button) {
  border-radius: 4px;
  font-weight: 500;
}

:deep(.el-dialog) {
  border-radius: 8px;
}
</style>
```

### 方式3：主题配置

```typescript
// main.ts
import ElementPlus from 'element-plus'
import 'element-plus/theme-chalk/index.css'

app.use(ElementPlus, {
  size: 'default',
  zIndex: 3000,
})
```

---

## 最佳实践

### ✅ 推荐做法

#### 1. 使用CSS变量

```scss
/* ✅ 好 */
.button {
  color: var(--color-primary);
  padding: var(--spacing-md);
}

/* ❌ 不好 */
.button {
  color: #409eff;
  padding: 16px;
}
```

#### 2. 使用BEM命名

```scss
/* ✅ 好 */
.book-card { }
.book-card__title { }
.book-card--featured { }

/* ❌ 不好 */
.bookCard { }
.book-card-title { }
.featuredBookCard { }
```

#### 3. 避免深层嵌套

```scss
/* ✅ 好 */
.book-card { }
.book-card__header { }
.book-card__title { }

/* ❌ 不好 */
.book-card .header .title { }
.page .content .section .book .card .title { }
```

#### 4. 使用Flexbox/Grid

```scss
/* ✅ 好 - Flexbox */
.book-list {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
}

/* ✅ 好 - Grid */
.book-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 20px;
}

/* ❌ 不好 - Float */
.book-item {
  float: left;
  margin-right: 16px;
}
```

#### 5. 组件样式隔离

```vue
<!-- ✅ 好 -->
<style scoped>
.title {
  font-size: 18px;
}
</style>

<!-- ❌ 不好 -->
<style>
.title {
  font-size: 18px;
}
</style>
```

#### 6. 避免!important

```scss
/* ✅ 好 */
.button {
  color: var(--color-primary);
}

.button:hover {
  color: var(--color-primary-dark);
}

/* ❌ 不好 */
.button {
  color: var(--color-primary) !important;
}
```

#### 7. 使用语义化类名

```html
<!-- ✅ 好 -->
<div class="book-card">
  <h3 class="book-card__title">书名</h3>
  <p class="book-card__author">作者</p>
</div>

<!-- ❌ 不好 -->
<div class="box">
  <h3 class="title-big">书名</h3>
  <p class="text-gray">作者</p>
</div>
```

### ❌ 避免的做法

#### 1. 内联样式

```vue
<!-- ❌ 避免 -->
<div style="color: red; font-size: 14px;">
  内容
</div>

<!-- ✅ 推荐 -->
<div class="error-text">
  内容
</div>
```

#### 2. 过度使用全局样式

```vue
<!-- ❌ 避免 -->
<style>
.title { font-size: 18px; }
.button { padding: 12px; }
</style>

<!-- ✅ 推荐 -->
<style scoped>
.book-card__title { font-size: 18px; }
.book-card__button { padding: 12px; }
</style>
```

#### 3. 硬编码数值

```scss
/* ❌ 避免 */
.card {
  padding: 16px;
  margin: 24px;
  border-radius: 8px;
}

/* ✅ 推荐 */
.card {
  padding: var(--spacing-md);
  margin: var(--spacing-lg);
  border-radius: var(--border-radius-large);
}
```

---

## 常见问题

### Q: 如何覆盖 Element Plus 样式？

**A**: 有三种方式：

1. 使用 `:deep()` 选择器
2. 在全局样式文件中覆盖
3. 修改 CSS 变量

```vue
<style scoped>
/* 方式1：使用 :deep() */
:deep(.el-button) {
  border-radius: 4px;
}
</style>

<style>
/* 方式2：全局覆盖 */
.el-button {
  border-radius: 4px;
}
</style>
```

### Q: 何时使用 scoped 样式？

**A**: 
- ✅ **组件样式**：始终使用 scoped
- ❌ **全局样式**：在全局样式文件中，不使用 scoped
- ❌ **第三方组件覆盖**：需要覆盖第三方组件时，使用 `:deep()` 或全局样式

### Q: 如何实现暗色模式？

**A**: 使用 CSS 变量和 data 属性：

```scss
:root {
  --bg-base: #ffffff;
  --text-primary: #303133;
}

[data-theme="dark"] {
  --bg-base: #1a1a1a;
  --text-primary: #e5eaf3;
}
```

```typescript
// 切换主题
document.documentElement.setAttribute('data-theme', 'dark')
```

### Q: 如何处理响应式设计？

**A**: 使用移动优先的 Media Queries：

```scss
/* 移动端（默认） */
.container {
  padding: 16px;
}

/* 平板及以上 */
@media (min-width: 768px) {
  .container {
    padding: 24px;
  }
}

/* 桌面及以上 */
@media (min-width: 1024px) {
  .container {
    padding: 32px;
  }
}
```

---

## 工具和资源

### 推荐工具

1. **CSS变量管理**: [CSS Vars Ponyfill](https://github.com/jhildenbiddle/css-vars-ponyfill)
2. **PostCSS插件**: autoprefixer, cssnano
3. **样式Lint**: stylelint
4. **设计工具**: Figma, Sketch

### 参考资源

- [BEM命名规范](http://getbem.com/)
- [CSS变量指南](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_custom_properties)
- [Element Plus主题](https://element-plus.org/zh-CN/guide/theming.html)
- [Vue Scoped CSS](https://vuejs.org/api/sfc-css-features.html)

---

**维护者**: 前端团队  
**最后更新**: 2025-10-29  
**版本**: v1.0.0

