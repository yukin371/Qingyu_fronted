# 青羽平台 - 工具使用指南

> **版本**: v1.0.0  
> **最后更新**: 2025-10-29  
> **适用范围**: 所有前端开发

---

## 📋 目录

1. [开发工具链](#开发工具链)
2. [构建工具](#构建工具)
3. [代码质量工具](#代码质量工具)
4. [Git工作流](#git工作流)
5. [调试工具](#调试工具)
6. [测试工具](#测试工具)

---

## 开发工具链

### VSCode 配置

#### 必装扩展

```json
{
  "recommendations": [
    "vue.volar",                    // Vue 3 语言支持
    "vue.vscode-typescript-vue-plugin", // Vue TypeScript
    "dbaeumer.vscode-eslint",       // ESLint
    "esbenp.prettier-vscode",       // Prettier
    "bradlc.vscode-tailwindcss",    // Tailwind CSS 智能提示
    "lokalise.i18n-ally",           // 国际化支持
    "antfu.iconify",                // 图标预览
    "gruntfuggly.todo-tree",        // TODO 高亮
    "usernamehw.errorlens",         // 行内错误显示
    "christian-kohler.path-intellisense", // 路径智能提示
    "ms-ceintl.vscode-language-pack-zh-hans" // 中文语言包
  ]
}
```

#### 工作区设置

创建 `.vscode/settings.json`：

```json
{
  // 编辑器设置
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.tabSize": 2,
  "editor.detectIndentation": false,
  
  // Vue 设置
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  
  // TypeScript 设置
  "[typescript]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  
  // 文件关联
  "files.associations": {
    "*.vue": "vue"
  },
  
  // ESLint 设置
  "eslint.validate": [
    "javascript",
    "javascriptreact",
    "typescript",
    "typescriptreact",
    "vue"
  ],
  
  // Tailwind CSS
  "tailwindCSS.experimental.classRegex": [
    ["class:\\s*?[\"'`]([^\"'`]*).*?,", "[\"'`]([^\"'`]*).*?[\"'`]"]
  ],
  
  // 排除文件
  "files.exclude": {
    "**/.git": true,
    "**/.DS_Store": true,
    "**/node_modules": true,
    "**/dist": true
  },
  
  // 搜索排除
  "search.exclude": {
    "**/node_modules": true,
    "**/dist": true,
    "**/.git": true,
    "**/pnpm-lock.yaml": true
  }
}
```

#### 代码片段

创建 `.vscode/vue3-snippets.json`：

```json
{
  "Vue 3 Composition API Component": {
    "prefix": "v3setup",
    "body": [
      "<template>",
      "  <div class=\"${1:component-name}\">",
      "    ${2:<!-- content -->}",
      "  </div>",
      "</template>",
      "",
      "<script setup lang=\"ts\">",
      "import { ref, computed } from 'vue'",
      "",
      "defineProps<{",
      "  ${3:// props}",
      "}>()",
      "",
      "defineEmits<{",
      "  ${4:// emits}",
      "}>()",
      "",
      "${5:// component logic}",
      "</script>",
      "",
      "<style scoped>",
      ".${1:component-name} {",
      "  ${6:/* styles */}",
      "}",
      "</style>"
    ],
    "description": "Vue 3 Composition API component template"
  },
  
  "Pinia Store": {
    "prefix": "pinia-store",
    "body": [
      "import { defineStore } from 'pinia'",
      "import { ref, computed } from 'vue'",
      "",
      "export const use${1:Name}Store = defineStore('${2:name}', () => {",
      "  // State",
      "  const ${3:state} = ref(${4:null})",
      "  ",
      "  // Getters",
      "  const ${5:getter} = computed(() => ${3:state}.value)",
      "  ",
      "  // Actions",
      "  async function ${6:action}() {",
      "    ${7:// action logic}",
      "  }",
      "  ",
      "  return {",
      "    ${3:state},",
      "    ${5:getter},",
      "    ${6:action}",
      "  }",
      "})"
    ],
    "description": "Pinia store template"
  }
}
```

#### 快捷键配置

常用快捷键：

| 快捷键             | 功能         |
| ------------------ | ------------ |
| `Ctrl + Shift + P` | 命令面板     |
| `Ctrl + P`         | 快速打开文件 |
| `Ctrl + B`         | 切换侧边栏   |
| `Ctrl + Shift + F` | 全局搜索     |
| `Ctrl + Shift + H` | 全局替换     |
| `Alt + Shift + F`  | 格式化文档   |
| `F2`               | 重命名符号   |
| `F12`              | 跳转到定义   |
| `Shift + F12`      | 查找所有引用 |
| `Ctrl + /`         | 切换注释     |

---

## 构建工具

### Vite 配置

#### 基础配置

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  
  // 路径别名
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
      '@core': resolve(__dirname, 'src/core'),
      '@shared': resolve(__dirname, 'src/shared'),
      '@bookstore': resolve(__dirname, 'src/modules/bookstore'),
      '@reader': resolve(__dirname, 'src/modules/reader'),
      '@writer': resolve(__dirname, 'src/modules/writer'),
      '@user': resolve(__dirname, 'src/modules/user'),
      '@admin': resolve(__dirname, 'src/modules/admin'),
    }
  },
  
  // 开发服务器
  server: {
    port: 5173,
    host: true,
    open: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
      }
    }
  },
  
  // 构建配置
  build: {
    outDir: 'dist',
    sourcemap: false,
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    },
    rollupOptions: {
      output: {
        manualChunks: {
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          'element-plus': ['element-plus'],
        }
      }
    }
  }
})
```

#### 环境变量

```bash
# .env.development
VITE_APP_TITLE=青羽写作平台（开发）
VITE_API_BASE_URL=http://localhost:8080/api/v1
VITE_PORT=5173

# .env.production
VITE_APP_TITLE=青羽写作平台
VITE_API_BASE_URL=https://api.qingyu.com/api/v1
```

使用环境变量：

```typescript
// 获取环境变量
const apiBaseUrl = import.meta.env.VITE_API_BASE_URL
const appTitle = import.meta.env.VITE_APP_TITLE

// 判断环境
const isDev = import.meta.env.DEV
const isProd = import.meta.env.PROD
```

### 常用命令

```bash
# 开发环境启动
npm run dev
pnpm dev

# 生产构建
npm run build
pnpm build

# 预览构建结果
npm run preview
pnpm preview

# TypeScript 类型检查
npm run type-check
pnpm type-check

# 代码检查
npm run lint
pnpm lint
```

---

## 代码质量工具

### ESLint 配置

#### 安装依赖

```bash
pnpm add -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-plugin-vue
```

#### 配置文件

```javascript
// eslint.config.js
import pluginVue from 'eslint-plugin-vue'
import vueTsEslintConfig from '@vue/eslint-config-typescript'

export default [
  ...pluginVue.configs['flat/recommended'],
  ...vueTsEslintConfig(),
  {
    rules: {
      // Vue 规则
      'vue/multi-word-component-names': 'error',
      'vue/no-unused-vars': 'error',
      'vue/require-default-prop': 'off',
      'vue/require-explicit-emits': 'error',
      'vue/component-name-in-template-casing': ['error', 'PascalCase'],
      
      // TypeScript 规则
      '@typescript-eslint/no-explicit-any': 'warn',
      '@typescript-eslint/no-unused-vars': 'error',
      '@typescript-eslint/explicit-function-return-type': 'off',
      
      // 通用规则
      'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
      'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off',
      'semi': ['error', 'never'],
      'quotes': ['error', 'single'],
      'indent': ['error', 2],
      'comma-dangle': ['error', 'always-multiline'],
    }
  }
]
```

#### 忽略文件

```bash
# .eslintignore
node_modules/
dist/
public/
*.config.js
*.config.ts
```

### Prettier 配置

#### 配置文件

```json
// .prettierrc
{
  "semi": false,
  "singleQuote": true,
  "trailingComma": "es5",
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "endOfLine": "lf",
  "arrowParens": "avoid",
  "vueIndentScriptAndStyle": false
}
```

#### 忽略文件

```bash
# .prettierignore
node_modules/
dist/
public/
pnpm-lock.yaml
```

### TypeScript 配置

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "preserve",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,

    /* Path Alias */
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "@core/*": ["./src/core/*"],
      "@shared/*": ["./src/shared/*"],
      "@bookstore/*": ["./src/modules/bookstore/*"],
      "@reader/*": ["./src/modules/reader/*"],
      "@writer/*": ["./src/modules/writer/*"],
      "@user/*": ["./src/modules/user/*"],
      "@admin/*": ["./src/modules/admin/*"]
    }
  },
  "include": ["src/**/*.ts", "src/**/*.d.ts", "src/**/*.tsx", "src/**/*.vue"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

---

## Git工作流

### 分支策略

```
master/main    - 主分支（生产环境）
  ↓
develop        - 开发分支
  ↓
feature/*      - 功能分支
hotfix/*       - 紧急修复分支
release/*      - 发布分支
```

### 分支命名规范

```bash
# 功能分支
feature/user-login
feature/book-search
feature/ai-writing

# 修复分支
hotfix/login-error
hotfix/search-bug

# 发布分支
release/v1.0.0
release/v1.1.0
```

### 提交信息规范

采用 **Conventional Commits** 规范：

```
<type>(<scope>): <subject>

<body>

<footer>
```

#### Type 类型

| Type       | 说明                   |
| ---------- | ---------------------- |
| `feat`     | 新功能                 |
| `fix`      | Bug修复                |
| `docs`     | 文档更新               |
| `style`    | 代码格式（不影响功能） |
| `refactor` | 重构                   |
| `perf`     | 性能优化               |
| `test`     | 测试相关               |
| `chore`    | 构建/工具变动          |
| `revert`   | 回滚                   |

#### 示例

```bash
# 新功能
feat(auth): 添加用户登录功能

# Bug修复
fix(reader): 修复阅读进度保存失败的问题

# 文档
docs(readme): 更新安装说明

# 样式
style(button): 统一按钮样式

# 重构
refactor(api): 重构API请求封装

# 性能优化
perf(list): 优化长列表渲染性能

# 测试
test(auth): 添加登录功能单元测试

# 构建
chore(deps): 更新依赖版本
```

### Git Hooks

使用 Husky 配置 Git Hooks：

```bash
# 安装 Husky
pnpm add -D husky lint-staged

# 初始化
npx husky install
```

#### Pre-commit Hook

```bash
# .husky/pre-commit
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

npx lint-staged
```

#### Lint-staged 配置

```json
// package.json
{
  "lint-staged": {
    "*.{js,ts,vue}": [
      "eslint --fix",
      "prettier --write"
    ],
    "*.{css,scss,vue}": [
      "prettier --write"
    ]
  }
}
```

### 常用 Git 命令

```bash
# 创建并切换到新分支
git checkout -b feature/new-feature

# 查看状态
git status

# 添加文件
git add .

# 提交
git commit -m "feat(module): 添加新功能"

# 推送到远程
git push origin feature/new-feature

# 拉取最新代码
git pull origin develop

# 合并分支
git merge develop

# 查看日志
git log --oneline --graph

# 撤销工作区修改
git checkout -- <file>

# 撤销暂存区
git reset HEAD <file>

# 回退提交
git reset --soft HEAD~1  # 保留修改
git reset --hard HEAD~1  # 丢弃修改
```

---

## 调试工具

### Vue DevTools

#### 安装

- Chrome: [Vue.js devtools](https://chrome.google.com/webstore/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd)
- Firefox: [Vue.js devtools](https://addons.mozilla.org/en-US/firefox/addon/vue-js-devtools/)

#### 功能

1. **组件树查看**：查看组件层级结构
2. **状态检查**：查看和修改组件状态
3. **事件追踪**：追踪组件事件
4. **Pinia状态**：查看和修改Store状态
5. **路由信息**：查看当前路由
6. **性能分析**：组件渲染性能分析

### Browser DevTools

#### Console 调试

```typescript
// 开发环境打印日志
if (import.meta.env.DEV) {
  console.log('Debug info:', data)
}

// 分组日志
console.group('User Info')
console.log('Name:', user.name)
console.log('Email:', user.email)
console.groupEnd()

// 表格显示
console.table(users)

// 计时
console.time('API Call')
await fetchData()
console.timeEnd('API Call')
```

#### Network 调试

1. 查看请求/响应
2. 检查请求头
3. 查看响应时间
4. 过滤请求类型
5. 保存请求为 cURL

#### Performance 分析

1. 录制性能
2. 查看帧率
3. 分析耗时操作
4. 查看内存使用

### VSCode 调试配置

创建 `.vscode/launch.json`：

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "chrome",
      "request": "launch",
      "name": "Launch Chrome",
      "url": "http://localhost:5173",
      "webRoot": "${workspaceFolder}/src",
      "sourceMaps": true
    }
  ]
}
```

---

## 测试工具

### Vitest（推荐）

#### 安装

```bash
pnpm add -D vitest @vue/test-utils happy-dom
```

#### 配置

```typescript
// vite.config.ts
import { defineConfig } from 'vite'

export default defineConfig({
  test: {
    environment: 'happy-dom',
    coverage: {
      provider: 'c8',
      reporter: ['text', 'json', 'html']
    }
  }
})
```

#### 测试示例

```typescript
// BookCard.test.ts
import { mount } from '@vue/test-utils'
import { describe, it, expect } from 'vitest'
import BookCard from './BookCard.vue'

describe('BookCard', () => {
  it('renders book info correctly', () => {
    const wrapper = mount(BookCard, {
      props: {
        book: {
          id: '1',
          title: 'Test Book',
          author: 'Test Author'
        }
      }
    })
    
    expect(wrapper.text()).toContain('Test Book')
    expect(wrapper.text()).toContain('Test Author')
  })
  
  it('emits click event', async () => {
    const wrapper = mount(BookCard, {
      props: { book: { id: '1', title: 'Test' } }
    })
    
    await wrapper.trigger('click')
    
    expect(wrapper.emitted('click')).toBeTruthy()
  })
})
```

#### 运行测试

```bash
# 运行所有测试
pnpm test

# 监听模式
pnpm test --watch

# 生成覆盖率报告
pnpm test --coverage
```

### E2E 测试（Playwright）

#### 安装

```bash
pnpm add -D @playwright/test
npx playwright install
```

#### 测试示例

```typescript
// e2e/login.spec.ts
import { test, expect } from '@playwright/test'

test('user can login', async ({ page }) => {
  await page.goto('http://localhost:5173/login')
  
  await page.fill('input[name="username"]', 'testuser')
  await page.fill('input[name="password"]', 'password123')
  await page.click('button[type="submit"]')
  
  await expect(page).toHaveURL('/dashboard')
})
```

---

## 实用工具

### 包管理工具

推荐使用 **pnpm**：

```bash
# 安装 pnpm
npm install -g pnpm

# 安装依赖
pnpm install

# 添加依赖
pnpm add vue
pnpm add -D vite

# 更新依赖
pnpm update

# 删除依赖
pnpm remove vue
```

### API 测试工具

1. **Postman**: 功能强大的 API 测试工具
2. **Insomnia**: 简洁的 REST 客户端
3. **Thunder Client**: VSCode 插件

### 性能分析工具

1. **Lighthouse**: Chrome 内置
2. **WebPageTest**: 在线性能测试
3. **Bundle Analyzer**: 分析打包体积

```bash
# 安装 rollup-plugin-visualizer
pnpm add -D rollup-plugin-visualizer

# 构建并生成报告
pnpm build --report
```

---

## 参考资料

- [Vite 文档](https://vitejs.dev/)
- [Vue 3 文档](https://vuejs.org/)
- [TypeScript 文档](https://www.typescriptlang.org/)
- [ESLint 文档](https://eslint.org/)
- [Prettier 文档](https://prettier.io/)
- [Conventional Commits](https://www.conventionalcommits.org/)

---

**维护者**: 前端团队  
**最后更新**: 2025-10-29  
**版本**: v1.0.0

